[
  {
    "path": "posts/2021-04-18-test-post2/",
    "title": "Test Post2",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Nes, Rasmus",
        "url": {}
      }
    ],
    "date": "2021-04-18",
    "categories": [],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": {},
    "last_modified": "2021-04-18T19:15:22+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-04-18-why-i-chose-r-distill-on-firebase-for-my-homepage/",
    "title": "Why I chose R Distill on Firebase for my homepage",
    "description": "Briefly on why I chose to use `R distill` and host it on Firebase Hosting.",
    "author": [
      {
        "name": "Nes, Rasmus",
        "url": {}
      }
    ],
    "date": "2021-04-18",
    "categories": [],
    "contents": "\n\nContents\nWhy Distill for R MarkdownWhat about Python?\n\nWhy Firebase\n\nI thought I might briefly share why I‚Äôve chosen Distill for R Markdown as the ‚Äúframework‚Äù for my homepage, and why I prefer to host it on on Firebase Hosting.\nWhy Distill for R Markdown\nPerhaps most importantly, it is really easy to set up and deploy (kudos to the RStudio team üëè). After having made an RStudio project of a Distill blog, it is very easy to add blog posts from within RStudio and then push to Github (more on Github integration with Firebase below).\nThomas Mock‚Äôs summary on Pros and Cons of R distill sums it up nicely. Here is my ‚Äúpersonal‚Äù list on essentially the same:\nNo Hugo or other build dependencies. If I want to add a new blog post, I simply write a new distill R Markdown document and compile/Knit it to static HTML, then push to Github. No framework build step or anything. This as little overhead as I can imagine.\nNo version dependencies. I am not sure I‚Äôll blog very often, but when I do I want it to be hassle-free; I want to focus all my time and effort on making the blog post, not getting the blog to work. Even though, say, my next blog post might be in two years time, I could confidently update all my R packages and be sure that as long as my blog post compiles to HTML it can easily be added to my blog. This is in contrast to frameworks like Hugo, where you‚Äôd risk running into compatibility issues and you‚Äôd need to occasionally update your Hugo version (with the risk of screwing things up since I‚Äôve long forgotten how to set up this damn blog.)\ndistill::import_post() Some times I think it would make more sense to write the blog post in the repo of the project that I‚Äôve been working on rather than the workflow of 1. create project and 2. create blog post about it in this homepage RStudio project. import_post() easily enables this.\nAnd, of course, I really like to work with R Markdown in RStudio for creating reports/blog posts, and Distill articles seems to be a sort of an enhanced version of ‚Äúvanilla‚Äù R Markdown (I especially like the nice code folding and easy control of width of tables and figures).\nWhat about Python?\nA current learning goal is to get more familiar with deep learning frameworks like Tensorflow and PyTorch, so I am likely to spend more time in Python than in R on my side projects. I haven‚Äôt panned out exactly how I could easily integrate my work in Python on this blog, but I am pretty sure I will figure something out. There‚Äôs the excellent reticulate package which certainly could be suitable in some cases. However, I think that if I spend most of my time working in Jupyter Notebook/Colab, I am hoping a can find a way to embed such notebooks in my blog posts rather than ‚Äúrewriting‚Äù them with reticulate. I am sure I will figure something out :)\nWhy Firebase\nThe primary reason for chosing Firebase over Github pages, Netlify etc. is the simple integration with Cloud Functions. I am very fond of Google Cloud Platform‚Äôs Cloud Run, which I would use to host the dashboard apps or APIs for my side projects.\nFirebase has nice Github integration, which enables one to work on blog post drafts in git branches. In addition, It could be fun to try out some of the Firebase ML integration with Google Cloud ML services.\n\n\n\n",
    "preview": {},
    "last_modified": "2021-04-18T21:38:21+02:00",
    "input_file": "why-i-chose-r-distill-on-firebase-for-my-homepage.utf8.md"
  },
  {
    "path": "posts/2021-04-18-jupyter-notebook-integration-test/",
    "title": "Jupyter Notebook integration test",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Nes, Rasmus",
        "url": {}
      }
    ],
    "date": "2021-04-18",
    "categories": [],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\nimport math\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nplt.rcParams[\"figure.figsize\"] = [15, 7]\n\n\nImports\n\ncustomers = pd.read_csv(\"Archive/customers.csv\")\norder_lines = pd.read_csv(\"Archive/order_lines.csv\")\nproducts = pd.read_csv(\"Archive/products.csv\")\nzip_places = pd.read_csv(\"Archive/zip_places.csv\")\n\n\n# Join data\norder_products = pd.merge(order_lines, products, on=\"product_id\")\norder_products[\"delivery_date\"] = pd.to_datetime(order_products[\"delivery_date\"])\norder_products[\"delivery_week\"] = (\n    order_products[\"delivery_date\"].dt.to_period(\"W\").apply(lambda r: r.start_time)\n)\n\n\norder_products\n\n\n\n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\n      order_id\n      customer_id\n      delivery_date\n      is_delivery\n      zip_place\n      product_id\n      quantity\n      net_unit_price\n      is_from_recipe\n      is_from_product_list\n      product_name\n      main_category\n      sub_category\n      brand\n      delivery_week\n    0\n      b5bd36902333660e728adbca18e72db305028c00\n      42d70c111366c2e57877a60da9482448c16a92c2\n      2018-01-01\n      True\n      Oslo\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-01-01\n    1\n      6ef34c7dd4cad0434a552c322b6754d7502b9bde\n      f7e39cc322a01e357c9e9e4c90dd660dcfefe136\n      2018-03-12\n      True\n      Vinterbro\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-03-12\n    2\n      3210c4fd4d8e8ec894fad6638389585dee0c73b0\n      dc290c4c4245b2d3242f59f214cd20b136f9134c\n      2018-04-18\n      False\n      Oslo\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-04-16\n    3\n      3d9cb6cb5146bf5e3841016e1144d7dd418f81a6\n      2a795bec85389cd74c7b2a0be9032eeda42dc65e\n      2018-05-28\n      False\n      Oslo\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-05-28\n    4\n      a26da49bf193ead0fdb86d7e949b5d3887e8caeb\n      2a795bec85389cd74c7b2a0be9032eeda42dc65e\n      2018-08-05\n      False\n      Oslo\n      20329\n      1.0\n      46.09\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-07-30\n    ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n    262286\n      fa31252e60f895ba4d6a62bf1d7aa0b000f6dc45\n      de93f96e96c8652ee2bd410ded22c161a8b9f668\n      2018-12-31\n      True\n      Oslo\n      27470\n      1.0\n      112.96\n      False\n      False\n      Superlife Topping Traneb√¶r √òkologisk 200.00 g\n      Br√∏d og frokostblandinger\n      Frokostblandinger og gryn\n      Superlife\n      2018-12-31\n    262287\n      e3fa57a97071cbe8aafd21f192696ae541e21920\n      f5afa34b23f76f31cf1f21cca492683b525b69bd\n      2018-12-31\n      True\n      Oslo\n      14854\n      1.0\n      29.92\n      False\n      False\n      Yatzy i Eske Med 6 Terninger 1.00 stk\n      Husholdning og tekstil\n      Diverse husholdning\n      NaN\n      2018-12-31\n    262288\n      571b7c2f70357404fbe1b748b1a0c33e0906798e\n      737323a66ab8d73c6d428735e42bee317d2c8feb\n      2018-12-31\n      True\n      L√∏venstad\n      1125\n      1.0\n      49.52\n      False\n      False\n      Weifa Paracet Mikstur 24mg 60.00 ml\n      Legemidler og helsekost\n      Legemidler\n      Weifa\n      2018-12-31\n    262289\n      571b7c2f70357404fbe1b748b1a0c33e0906798e\n      737323a66ab8d73c6d428735e42bee317d2c8feb\n      2018-12-31\n      True\n      L√∏venstad\n      23564\n      1.0\n      32.96\n      False\n      False\n      FestligeTing Suger√∏r Bl√•  24.00 stk\n      Barneprodukter\n      Bursdag\n      FestligeTing\n      2018-12-31\n    262290\n      571b7c2f70357404fbe1b748b1a0c33e0906798e\n      737323a66ab8d73c6d428735e42bee317d2c8feb\n      2018-12-31\n      True\n      L√∏venstad\n      21049\n      1.0\n      29.12\n      False\n      False\n      Hansa Borg Borg √òstlandets Gull  0.50 l\n      √òl, cider og rusbrus\n      √òl\n      Hansa Borg\n      2018-12-31\n    262291 rows √ó 15 columns\n\n\nExploratory data analysis\n\norder_products.nunique()\n\n\norder_id                8580\ncustomer_id              946\ndelivery_date            359\nis_delivery                2\nzip_place                100\nproduct_id              5978\nquantity                  42\nnet_unit_price          3490\nis_from_recipe             2\nis_from_product_list       2\nproduct_name            5977\nmain_category             32\nsub_category             182\nbrand                    525\ndelivery_week             52\ndtype: int64\n\n\norder_products.dtypes\n\n\norder_id                 object\ncustomer_id              object\ndelivery_date            object\nis_delivery                bool\nzip_place                object\nproduct_id                int64\nquantity                float64\nnet_unit_price          float64\nis_from_recipe             bool\nis_from_product_list       bool\ndtype: object\n\n\n# Sum of all products by day and week\norder_products.groupby(\"delivery_date\").agg(quantity=(\"quantity\", \"sum\")).plot()\norder_products.groupby(\"delivery_week\").agg(quantity=(\"quantity\", \"sum\")).plot()\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\n\n\ndef plot_product_quantity(\n    product_id, group=\"product_name\", time_agg=\"delivery_date\", df=order_products\n):\n    df_prod = df.query(\"product_id == @product_id\")\n    category = df_prod[group].iloc[0]\n\n    if group == \"product_name\":\n        df_q = df_prod\n    elif group == \"main_category\":\n        df_q = df.query(\"main_category == @category\")\n    elif group == \"sub_category\":\n        df_q = df.query(\"sub_category == @category\")\n    else:\n        raise Exception(\"Invalid `group` parameter.\")\n\n    df_plot = df_q.groupby(time_agg).agg(n=(\"quantity\", \"sum\"))\n\n    if time_agg == \"delivery_date\":\n        idx = pd.date_range(\"2018-01-01\", \"2018-12-31\")\n        df_plot.index = pd.DatetimeIndex(df_plot.index)\n        df_plot = df_plot.reindex(idx, fill_value=0)\n\n    return df_plot.rename(columns={\"n\": category}).plot()\n\n\nplot_product_quantity(987)\nplot_product_quantity(16534)\n\n\n<AxesSubplot:>\n\n\n\n\n\n\n## Aggregate per week\nplot_product_quantity(987, time_agg=\"delivery_week\")\nplot_product_quantity(16534, time_agg=\"delivery_week\")\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\n\n\nplot_product_quantity(\n    products.sample().product_id.iloc[0],\n    group=\"main_category\",\n    time_agg=\"delivery_week\",\n)\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\nplot_product_quantity(\n    products.sample().product_id.iloc[0],\n    group=\"sub_category\",\n    time_agg=\"delivery_week\",\n)\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\nplot_product_quantity(\n    products.sample().product_id.iloc[0],\n    group=\"sub_category\",\n    time_agg=\"delivery_week\",\n)\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\nplot_product_quantity(\n    products.sample().product_id.iloc[0],\n    group=\"sub_category\",\n    time_agg=\"delivery_week\",\n)\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\nplot_product_quantity(\n    products.sample().product_id.iloc[0],\n    group=\"sub_category\",\n    time_agg=\"delivery_week\",\n)\n\n\n<AxesSubplot:xlabel='delivery_week'>\n\n\n\n\n\n\n\n\n\n\nPrepare data for Hierarchical model\n\norder_products\n\n\n\n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\n      order_id\n      customer_id\n      delivery_date\n      is_delivery\n      zip_place\n      product_id\n      quantity\n      net_unit_price\n      is_from_recipe\n      is_from_product_list\n      product_name\n      main_category\n      sub_category\n      brand\n      delivery_week\n    0\n      b5bd36902333660e728adbca18e72db305028c00\n      42d70c111366c2e57877a60da9482448c16a92c2\n      2018-01-01\n      True\n      Oslo\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-01-01\n    1\n      6ef34c7dd4cad0434a552c322b6754d7502b9bde\n      f7e39cc322a01e357c9e9e4c90dd660dcfefe136\n      2018-03-12\n      True\n      Vinterbro\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-03-12\n    2\n      3210c4fd4d8e8ec894fad6638389585dee0c73b0\n      dc290c4c4245b2d3242f59f214cd20b136f9134c\n      2018-04-18\n      False\n      Oslo\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-04-16\n    3\n      3d9cb6cb5146bf5e3841016e1144d7dd418f81a6\n      2a795bec85389cd74c7b2a0be9032eeda42dc65e\n      2018-05-28\n      False\n      Oslo\n      20329\n      1.0\n      45.22\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-05-28\n    4\n      a26da49bf193ead0fdb86d7e949b5d3887e8caeb\n      2a795bec85389cd74c7b2a0be9032eeda42dc65e\n      2018-08-05\n      False\n      Oslo\n      20329\n      1.0\n      46.09\n      False\n      False\n      Helios Fullkornris Lang  700.00 g\n      Middager og tilbeh√∏r\n      Ris og gryn\n      Helios\n      2018-07-30\n    ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n    262286\n      fa31252e60f895ba4d6a62bf1d7aa0b000f6dc45\n      de93f96e96c8652ee2bd410ded22c161a8b9f668\n      2018-12-31\n      True\n      Oslo\n      27470\n      1.0\n      112.96\n      False\n      False\n      Superlife Topping Traneb√¶r √òkologisk 200.00 g\n      Br√∏d og frokostblandinger\n      Frokostblandinger og gryn\n      Superlife\n      2018-12-31\n    262287\n      e3fa57a97071cbe8aafd21f192696ae541e21920\n      f5afa34b23f76f31cf1f21cca492683b525b69bd\n      2018-12-31\n      True\n      Oslo\n      14854\n      1.0\n      29.92\n      False\n      False\n      Yatzy i Eske Med 6 Terninger 1.00 stk\n      Husholdning og tekstil\n      Diverse husholdning\n      NaN\n      2018-12-31\n    262288\n      571b7c2f70357404fbe1b748b1a0c33e0906798e\n      737323a66ab8d73c6d428735e42bee317d2c8feb\n      2018-12-31\n      True\n      L√∏venstad\n      1125\n      1.0\n      49.52\n      False\n      False\n      Weifa Paracet Mikstur 24mg 60.00 ml\n      Legemidler og helsekost\n      Legemidler\n      Weifa\n      2018-12-31\n    262289\n      571b7c2f70357404fbe1b748b1a0c33e0906798e\n      737323a66ab8d73c6d428735e42bee317d2c8feb\n      2018-12-31\n      True\n      L√∏venstad\n      23564\n      1.0\n      32.96\n      False\n      False\n      FestligeTing Suger√∏r Bl√•  24.00 stk\n      Barneprodukter\n      Bursdag\n      FestligeTing\n      2018-12-31\n    262290\n      571b7c2f70357404fbe1b748b1a0c33e0906798e\n      737323a66ab8d73c6d428735e42bee317d2c8feb\n      2018-12-31\n      True\n      L√∏venstad\n      21049\n      1.0\n      29.12\n      False\n      False\n      Hansa Borg Borg √òstlandets Gull  0.50 l\n      √òl, cider og rusbrus\n      √òl\n      Hansa Borg\n      2018-12-31\n    262291 rows √ó 15 columns\n\n\ndf_model = (\n    order_products.groupby([\"delivery_week\", \"main_category\"])\n    .agg(quantity=(\"quantity\", \"sum\"))\n    .reset_index()\n    .query(\"delivery_week != '2018-12-31'\")  # Remove last, single day of year\n)\n\n\n# Add holidays by manual inspection. (Could easily be obtained in a real scenario from a calendar)\ndf_model[\"holiday\"] = np.select(\n    [\n        df_model[\"delivery_week\"] == \"2018-02-19\",  # Winter holidays\n        df_model[\"delivery_week\"] == \"2018-03-26\",  # Easter\n        df_model[\"delivery_week\"] == \"2018-07-02\",  # Summer/july holidays\n        df_model[\"delivery_week\"] == \"2018-07-09\",  # Summer/july holidays\n        df_model[\"delivery_week\"] == \"2018-07-16\",  # Summer/july holidays\n        df_model[\"delivery_week\"] == \"2018-07-23\",  # Summer/july holidays\n        df_model[\"delivery_week\"] == \"2018-12-24\",  # Christmas\n    ],\n    [1 for _ in range(7)],\n    default=0,\n)\n\n\ndf_model[\"last_quantity\"] = df_model.groupby(\"main_category\")[\"quantity\"].shift()\n\n\n# Skip first week due to missing 'last_quantity' and drop 'delivery_week' column\ndf_model = df_model.query(\"delivery_week != '2018-01-01'\").drop(\n    [\"delivery_week\"], axis=1\n)\n\n\ndf_model\n\n\n\n\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\n      main_category\n      quantity\n      holiday\n      last_quantity\n    30\n      Asiatisk\n      40.0\n      0\n      48.0\n    31\n      Barneprodukter\n      315.0\n      0\n      251.0\n    32\n      Blomster og planter\n      14.0\n      0\n      4.0\n    33\n      Br√∏d og frokostblandinger\n      498.0\n      0\n      516.0\n    34\n      Drikkevarer\n      567.0\n      0\n      412.0\n    ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n      ‚Ä¶\n    1527\n      Shampo, s√•pe og hudpleie\n      7.0\n      1\n      62.0\n    1528\n      Snacks og godteri\n      192.0\n      1\n      628.0\n    1529\n      Snus og tobakk\n      16.0\n      1\n      38.0\n    1530\n      T√∏rkepapir og vaskemidler\n      54.0\n      1\n      294.0\n    1531\n      √òl, cider og rusbrus\n      50.0\n      1\n      218.0\n    1502 rows √ó 4 columns\n\n\n# Check number of products, sub_category and main_category\nproducts.nunique()\n\n\nproduct_id       5978\nproduct_name     5977\nmain_category      32\nsub_category      182\nbrand             525\ndtype: int64\n\n\nProblem formulation\n\n\\[q_i \\sim Normal(\\mu_i, \\sigma)\\]\n\n\\[\\mu_i = \\alpha + \\alpha_{MAIN[i]} + \\alpha_{SUB[i]} + \\beta_{HOLIDAY[i]}H_i + \\beta_{TEMP[i]}T_i + \\beta_{PRECIP[i]}P_i + \\beta_{LASTQUANTITY[i]}Q_i\\]\n\n\\[\\alpha_{MAIN} \\sim Normal(0, \\sigma_{MAIN})\\]\n\n\\[\\alpha_{SUB} \\sim Normal(0, \\sigma_{SUB})\\]\n\n\\[\\alpha \\sim Normal(0, 10)\\]\n\n\\[\\beta_{HOLIDAY} \\sim Normal(0, \\sigma_{HOLIDAY})\\]\n\n\\[\\beta_{TEMP} \\sim Normal(0, \\sigma_{TEMP})\\]\n\n\\[\\beta_{PRECIP} \\sim Normal(0, \\sigma_{PRECIP})\\]\n\n\\[\\beta_{LASTQUANTITY} \\sim Normal(1, \\sigma_{LASTQUANTITY})\\]\n\n\\[\\sigma_{LASTQUANTITY} \\sim HalfCauchy(0, 1)\\]\n\n\\[\\sigma, \\sigma_{SUB}, \\sigma_{MAIN}, \\sigma_{HOLIDAY}, \\sigma_{TEMP}, \\sigma_{PRECIP} \\sim HalfCauchy(0, 1)\\]\n\nVariables explained\n\n\\(q_i\\) = quantity prediction for sub_category \\(i\\)\n\\(H\\) = holiday indicator variable\n\\(T\\) = temperature (forecasted)\n\\(P\\) = precipation (forecasted)\n\\(Q\\) = quantity observed last week for sub_category \\(i\\)\nThoughts\n\nFinal model will certainly not look like this.\nMultivariate Normal for TEMP and PRECIP?\nResiduals can be checked in \\(\\sigma\\)\n\n\n\n\n\n\n\n\n\n\n",
    "preview": {},
    "last_modified": "2021-04-18T22:00:42+02:00",
    "input_file": "jupyter-notebook-integration-test.utf8.md"
  }
]
